<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:bridge="bridge.*" xmlns:genvis="genvis.*" 
	layout="absolute" width="100%" height="100%" styleName="plain"
	 applicationComplete="init()">
   <bridge:FABridge bridgeName="flex" /> 
   <mx:Script>
		<![CDATA[
			import flare.display.DirtySprite;
			import mx.rpc.AsyncToken;
			import genvis.data.Person;
			import mx.controls.Alert;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			private function init():void{	

				setRoot(1);
			}
			private function resultHandler(e:ResultEvent):void {
//				var str:String = "asdfawrfh239urF iwiuHF289UJ FU 4f4";				
//				trace(str.split(" ", 2));		
//				if (e.result is Profile)
//					trace(true);
//				else 
//					trace(false);		    
//			    var root:Person = new Person();
//			    root.name = e.result.first_name+" "+e.result.last_name;
//			    root.gender = e.result.sex;
//			    root.date_of_birth = e.result.date_of_birth;
//			    root.date_of_death = e.result.date_of_death;
//			    root.id = e.result.id;
//			    Alert.show(root.gender);
			    vis.visualize(e.result as Person);
			    DirtySprite.renderDirty();    
			    	    		    
			}
			private function serviceFault(fe:FaultEvent):void {			    
			    Alert.show("An error occurred: " + fe.fault.faultString);
			}
	
			public function setRoot(id:int):void{
				AsyncToken(srv.root(id));
			}
			
		]]>
	</mx:Script>
   
	<mx:RemoteObject
	  id="srv"
	  destination="rubyamf"
	  source="ProfileController"	  
	  fault="serviceFault(event)"
	  showBusyCursor="true">
	  <mx:method name="root" result="resultHandler(event)"/>
	</mx:RemoteObject>
	<!--<mx:Button label="send" buttonDown="setRoot(1);"></mx:Button>-->
	
	<mx:HBox width="100%" height="100%">
		<genvis:GenVis id="vis" height="100%" backgroundColor="#FFFFFF" />
		<mx:Panel width="300" height="100%">		
		</mx:Panel>
	</mx:HBox>
</mx:Application>
